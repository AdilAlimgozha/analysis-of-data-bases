CREATE TABLE DENTIST(
DENTIST_ID VARCHAR(5) PRIMARY KEY,
DENTIST_NAME VARCHAR(50));

CREATE TABLE SURGERY(
SURGERY_NO VARCHAR(3) PRIMARY KEY,
SURGERY_NAME VARCHAR(50));

CREATE TABLE PATIENT(
PATIENT_NAME VARCHAR(50) PRIMARY KEY,
PATIENT_NO VARCHAR(4),
SURGERY_NO VARCHAR(3) FOREIGN KEY REFERENCES SURGERY(SURGERY_NO));

CREATE TABLE APPOINTMENT(
DENTIST_ID VARCHAR(5),
PATIENT_NAME VARCHAR(50),
APPOINTMENT_DATE DATE,
APPOINTMENT_TIME VARCHAR(50),
CONSTRAINT PK_APPOINTMENT PRIMARY KEY (DENTIST_ID, PATIENT_NAME, APPOINTMENT_DATE),
CONSTRAINT FK_APPOINTMENT_DENTIST FOREIGN KEY (DENTIST_ID) REFERENCES DENTIST(DENTIST_ID),
CONSTRAINT FK_APPOINTMENT_PATIENT FOREIGN KEY (PATIENT_NAME) REFERENCES PATIENT(PATIENT_NAME)
);


INSERT INTO DENTIST 
VALUES('D1011', 'ROGER'),
('D1025', 'HELEN'),
('D1035', 'PETER');

INSERT INTO SURGERY
VALUES('S1', 'PULPOTOMY'),
('S2', 'PULPECTOMY'),
('S11', 'APICOECTOMY');

INSERT INTO PATIENT
VALUES('SMITH', 'P100', 'S1'),
('ROBIN', 'P110', 'S2'),
('BELL', 'P105', 'S11'),
('AARON', 'P110', 'S2');

INSERT INTO APPOINTMENT
VALUES('D1011', 'SMITH', '2018-10-02', '10:00 AM'),
('D1011', 'ROBIN', '2018-10-03', '11:00 AM'),
('D1025', 'BELL', '2018-10-05', '10:00 AM'),
('D1025', 'BELL', '2018-10-10', '10:00 AM'),
('D1035', 'AARON', '2018-10-15', '10:00 AM');

SELECT D.DENTIST_ID, D.DENTIST_NAME, 
P.PATIENT_NO, P.PATIENT_NAME,
A.APPOINTMENT_DATE, A.APPOINTMENT_TIME, 
S.SURGERY_NO, S.SURGERY_NAME
FROM DENTIST D
JOIN APPOINTMENT A
ON D.DENTIST_ID = A.DENTIST_ID
JOIN PATIENT P
ON P.PATIENT_NAME = A.PATIENT_NAME
JOIN SURGERY S
ON S.SURGERY_NO = P.SURGERY_NO

SELECT * FROM DENTIST
SELECT * FROM SURGERY
SELECT * FROM PATIENT
SELECT * FROM APPOINTMENT